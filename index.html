<!DOCTYPE html>
<html lang="th" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏¥‡∏•‡∏ü‡∏≤‡∏£‡πå‡∏°‡∏Å‡∏∏‡πâ‡∏á</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-brand">
            <span class="brand-icon">ü¶ê</span>
            <span>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏¥‡∏•‡∏ü‡∏≤‡∏£‡πå‡∏°‡∏Å‡∏∏‡πâ‡∏á</span>
        </div>
        
        <div class="nav-links">
            <button class="nav-btn active" data-page="create" onclick="navigateTo('create')">
                <span class="nav-icon">üìù</span>
                <span class="nav-text">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏¥‡∏•</span>
            </button>
            <button class="nav-btn" data-page="history" onclick="navigateTo('history')">
                <span class="nav-icon">üìö</span>
                <span class="nav-text">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</span>
            </button>
            <button class="nav-btn" data-page="manage" onclick="navigateTo('manage')">
                <span class="nav-icon">üì¶</span>
                <span class="nav-text">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span>
            </button>
            <button class="nav-btn" data-page="settings" onclick="navigateTo('settings')">
                <span class="nav-icon">‚öôÔ∏è</span>
                <span class="nav-text">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span>
            </button>
        </div>
        
        <button class="theme-toggle" onclick="toggleTheme()" title="‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ò‡∏µ‡∏°">
            <span id="themeIcon">üåô</span>
        </button>
    </nav>

    <!-- CREATE BILL PAGE -->
    <div id="createPage" class="page active">
        <div class="page-header">
            <h1>üìù ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏¥‡∏•‡πÉ‡∏´‡∏°‡πà</h1>
            <p class="page-subtitle">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ü‡∏≤‡∏£‡πå‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡πà‡∏≠</p>
        </div>

        <div class="content-grid">
            <div class="info-card">
                <div class="form-group">
                    <label for="farmSelect">üè≠ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ü‡∏≤‡∏£‡πå‡∏°</label>
                    <select id="farmSelect" class="input-field" onchange="loadPonds()">
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ü‡∏≤‡∏£‡πå‡∏° --</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="billDate">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                    <input type="date" id="billDate" class="input-field">
                </div>

                <div id="pondCountDisplay" class="stat-badge" style="display: none;">
                    <span class="stat-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ö‡πà‡∏≠</span>
                    <span class="stat-value" id="pondCountValue">0</span>
                </div>
            </div>

            <div class="tips-card">
                <div class="card-header">
                    <h2>üí° ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö</h2>
                </div>
                <ul class="tips-list">
                    <li>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ü‡∏≤‡∏£‡πå‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡πà‡∏≠</li>
                    <li>‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏ö‡πà‡∏≠</li>
                    <li>‡πÉ‡∏ä‡πâ "‡∏´‡∏≤‡∏£‡∏ö‡πà‡∏≠" ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡πà‡∏á‡∏Å‡∏±‡∏ô</li>
                    <li>‡∏Å‡∏î‡∏¢‡∏∏‡∏ö/‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ö‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</li>
                </ul>
                <div class="shortcut-info">
                    ‚å®Ô∏è ‡∏Å‡∏î ESC ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á
                </div>
            </div>
        </div>

        <div id="pondsSection" style="display: none;">
            <div class="section-header">
                <h2>ü¶ê ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡πà‡∏≠</h2>
                <button class="btn-secondary" onclick="expandAllPonds()">üìÇ ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
            </div>
            
            <div id="pondsContainer"></div>
        </div>

        <div id="actionBar" class="action-bar" style="display: none;">
            <div class="total-display">
                <span class="total-label">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                <span class="total-amount" id="grandTotal">0.00 ‡∏ö‡∏≤‡∏ó</span>
            </div>
            <button class="btn-success btn-large" onclick="saveBill()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ö‡∏¥‡∏•</button>
        </div>
    </div>

    <!-- HISTORY PAGE -->
    <div id="historyPage" class="page">
        <div class="page-header">
            <h1>üìö ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ö‡∏¥‡∏•</h1>
            <p class="page-subtitle">‡∏î‡∏π ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ</p>
        </div>

        <div class="history-controls">
            <div class="search-box">
                <input type="text" id="historySearch" class="input-field" 
                       placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏≤‡∏£‡πå‡∏° ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏Ç‡∏ö‡∏¥‡∏•..." 
                       oninput="renderHistory()">
            </div>
            
            <div class="filter-group">
                <select id="historyFarmFilter" class="input-field" onchange="renderHistory()">
                    <option value="">‡∏ü‡∏≤‡∏£‡πå‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                </select>
                
                <select id="historySortBy" class="input-field" onchange="sortHistory()">
                    <option value="date-desc">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)</option>
                    <option value="date-asc">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (‡πÄ‡∏Å‡πà‡∏≤‡∏™‡∏∏‡∏î)</option>
                    <option value="total-desc">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° (‡∏°‡∏≤‡∏Å-‡∏ô‡πâ‡∏≠‡∏¢)</option>
                    <option value="total-asc">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° (‡∏ô‡πâ‡∏≠‡∏¢-‡∏°‡∏≤‡∏Å)</option>
                </select>
            </div>
        </div>

        <div id="historyList" class="history-grid"></div>
        
        <div id="emptyHistory" class="empty-state" style="display: none;">
            <div class="empty-icon">üìù</div>
            <h3>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</h3>
            <p>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏¥‡∏•‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</p>
            <button class="btn-primary btn-large" onclick="navigateTo('create')">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏¥‡∏•‡πÉ‡∏´‡∏°‡πà</button>
        </div>
    </div>

    <!-- MANAGE ASSETS PAGE (‡∏Ç‡πâ‡∏≠ 6: ‡∏õ‡∏£‡∏±‡∏ö Design) -->
    <div id="managePage" class="page">
        <div class="page-header">
            <h1>üì¶ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h1>
            <p class="page-subtitle">‡πÄ‡∏û‡∏¥‡πà‡∏° ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
        </div>

        <!-- ‡∏Ç‡πâ‡∏≠ 6: Section ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà -->
        <div class="add-section">
            <h2>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</h2>
            <div class="asset-add-form">
                <div class="form-group">
                    <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó (001-999)</label>
                    <input type="text" id="newAssetType" class="input-field" placeholder="‡πÄ‡∏ä‡πà‡∏ô 001">
                </div>
                <div class="form-group">
                    <label>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
                    <input type="text" id="newAssetName" class="input-field" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏à‡∏µ‡∏ö‡∏µ‡∏ó‡∏µ01">
                </div>
                <div class="form-group">
                    <label>‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)</label>
                    <input type="number" id="newAssetPrice" class="input-field" min="0" step="0.01" placeholder="0.00">
                </div>
                <div class="form-group">
                    <button class="btn-success btn-large" onclick="addNewAsset()" style="width: 100%;">
                        ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                    </button>
                </div>
            </div>
        </div>

        <!-- ‡∏Ç‡πâ‡∏≠ 6: ‡∏õ‡∏∏‡πà‡∏° Import/Export -->
        <div class="import-export-section">
            <button class="btn-secondary" onclick="saveAssetsToCSV()">üì• ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å Asset.txt</button>
            <button class="btn-secondary" onclick="exportAssets()">üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å CSV</button>
            <button class="btn-secondary" onclick="document.getElementById('importFile').click()">üì§ ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ CSV</button>
            <input type="file" id="importFile" accept=".csv,.txt" style="display: none" onchange="importAssets(event)">
        </div>

        <div id="assetList" class="asset-grid"></div>
    </div>

    <!-- SETTINGS PAGE (‡∏Ç‡πâ‡∏≠ 7: UI ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ü‡∏≤‡∏£‡πå‡∏°‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà) -->
    <div id="settingsPage" class="page">
        <div class="page-header">
            <h1>‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h1>
            <p class="page-subtitle">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ü‡∏≤‡∏£‡πå‡∏° ‡∏ö‡πà‡∏≠ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ</p>
        </div>

        <div class="settings-grid">
            <!-- ‡∏Ç‡πâ‡∏≠ 7: Farm Management ‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà (Table View) -->
            <div class="settings-section">
                <h2>üè≠ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ü‡∏≤‡∏£‡πå‡∏°‡πÅ‡∏•‡∏∞‡∏ö‡πà‡∏≠</h2>
                
                <div class="farm-table-view">
                    <div id="farmTableContainer"></div>
                </div>

                <div class="button-group" style="margin-top: 1rem;">
                    <button class="btn-primary" onclick="toggleNameEditor()">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏≤‡∏£‡πå‡∏°‡πÅ‡∏•‡∏∞‡∏ö‡πà‡∏≠</button>
                    <button class="btn-warning" onclick="resetToDefault()">üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</button>
                </div>
            </div>

            <!-- Data Management -->
            <div class="settings-section">
                <h2>üíæ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
                
                <div class="stats-overview">
                    <div class="stat-card">
                        <div class="stat-icon">üì¶</div>
                        <div class="stat-info">
                            <div class="stat-number" id="totalAssets">0</div>
                            <div class="stat-desc">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìö</div>
                        <div class="stat-info">
                            <div class="stat-number" id="totalBills">0</div>
                            <div class="stat-desc">‡∏ö‡∏¥‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</div>
                        </div>
                    </div>
                </div>

                <div class="button-group vertical">
                    <button class="btn-secondary" onclick="backupData()">üíæ ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                    <button class="btn-secondary" onclick="document.getElementById('restoreFile').click()">üì• ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                    <input type="file" id="restoreFile" accept=".json" style="display: none" onchange="restoreData(event)">
                    <button class="btn-danger" onclick="clearAllData()">üóëÔ∏è ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                </div>

                <div class="info-box">
                    <strong>üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏π‡∏ç‡∏´‡∏≤‡∏¢
                </div>
            </div>
        </div>

        <!-- Name Editor (Hidden by default) -->
        <div id="nameEditorSection" class="name-editor" style="display: none;">
            <div class="editor-header">
                <h2>‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏≤‡∏£‡πå‡∏°‡πÅ‡∏•‡∏∞‡∏ö‡πà‡∏≠</h2>
                <button class="close-btn" onclick="toggleNameEditor()">√ó</button>
            </div>
            <div id="nameEditorContent"></div>
            <div class="editor-actions">
                <button class="btn-success btn-large" onclick="saveNameChanges()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á</button>
                <button class="btn-secondary" onclick="toggleNameEditor()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- Bill Preview Modal -->
    <div id="billPreviewModal" class="modal">
        <div class="modal-content bill-preview">
            <div class="modal-header">
                <h2>üìÑ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ö‡∏¥‡∏•</h2>
                <button class="close-btn" onclick="closeBillPreview()">√ó</button>
            </div>
            <div class="bill-display">
                <div id="billPreviewContent"></div>
            </div>
            <div class="modal-actions">
                <button class="btn-success" onclick="exportCurrentBill()">üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF</button>
                <button class="btn-danger" onclick="deleteCurrentBill()">üóëÔ∏è ‡∏•‡∏ö‡∏ö‡∏¥‡∏•</button>
                <button class="btn-secondary" onclick="closeBillPreview()">‡∏õ‡∏¥‡∏î</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="loading-spinner" style="display: none;">
        <div class="spinner"></div>
        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...</p>
    </div>

    <script src="js/app.js"></script>
</body>
</html>